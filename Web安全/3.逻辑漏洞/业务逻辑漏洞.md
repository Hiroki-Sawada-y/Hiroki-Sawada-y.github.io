## 什么是业务逻辑漏洞
> 业务逻辑漏洞是指应用程序设计和实现中的缺陷，允许攻击者引发意外行为。这可能使攻击者能够操纵合法功能以实现恶意目标。这些缺陷通常是由于未能预测可能发生的异常应用状态，因此未能安全地处理这些缺陷。

![](../media/Buslogic.png)
## 实验室

### [Excessive trust in client-side controls](https://portswigger.net/web-security/logic-flaws/examples#excessive-trust-in-client-side-controls)

> 过度信任客户端，一个根本上有缺陷的假设是，用户只会通过提供的Web界面与应用程序交互。

#### Lab1 修改商品价格(前端)
1. 皮夹克价格![](../media/logic-lab-1.1.png)
2. 购买，抓包![](../media/logic-lab-1.2.png)
3. 修改13700为0.1
4. 付款![](../media/logic-lab-1.3.png)
5. 影响：💵接受表面价值的数据，而不执行适当的完整性检查和服务器端验证，可以允许攻击者以相对最小的努力造成各种破坏。
#### Lab2 2FA broken logic

#### Lab3 突破功能限制
1. 无法查询： 
![](../media/突破功能限制.png)
2. 删除dis关键字
![](../media/dis关键字.png)

### [Failing to handle unconventional input](https://portswigger.net/web-security/logic-flaws/examples#excessive-trust-in-client-side-controls)

#### Lab1 High-level logic vulnerability
1. 增加-数量商品至购物车
![](../media/High-level-logic.png)
2. 购买足够多的其余商品，使得总价格不低于0，购买
![](../media/lab1-high-level=logic.png)

#### Lab2 Low-level logic flaw


## 扩展

### Paper
[业务逻辑漏洞](https://portswigger.net/web-security/logic-flaws)